
% 编程
\usepackage{ifthen}

% 数学
\usepackage{amsmath}
\usepackage{amssymb}
\everymath{\displaystyle}

% 颜色
\usepackage[dvipsnames, table]{xcolor} % cmyk
\definecolor{CarminePink}{HTML/cmyk}{EB6160/0.01,0.83,0.71,0.01}
\definecolor{SmrtSunglo}{HTML}{EB6160}
\definecolor{LightCoral}{HTML}{EE7B7A}
\definecolor{SeaPink}{HTML}{F19595}
\definecolor{BeautyBush}{HTML}{F5B0AF}
\definecolor{LightRose}{HTML}{F8CACA}
\definecolor{LightPink}{HTML}{F19595}
\definecolor{MistyRose}{HTML}{FBE4E4}

\definecolor{Primary}{HTML/cmyk}{1E5AF0/0.58,0.35,0,0}
\definecolor{Info}{HTML}{8296A6}
\definecolor{Danger}{HTML}{FF3B30}
\definecolor{Warning}{HTML}{FEAF16}
\definecolor{Card}{HTML}{374148}

\definecolor{th}{HTML/cmyk}{EB6160/0.01,0.83,0.71,0.01}
\definecolor{thText}{HTML}{FFFFFF}
\definecolor{trOdd}{HTML}{F9FAFA}
\definecolor{trEven}{HTML}{EAEAEA}
\definecolor{td}{HTML}{FBE4E4}

\usepackage{tcolorbox}

% 绘图
\usepackage{tikz}
\usetikzlibrary{shapes,backgrounds}

% 索引
\usepackage{makeidx}
\makeindex

% 图片
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{float}

% 表格
\usepackage{array}
\usepackage{tabularx}
\usepackage{multirow}
\usepackage{threeparttable}
\newcommand{\minitab}[2][l]{\begin{tabular}{#1}#2\end{tabular}}
\newcommand{\Th}[1]{\multicolumn{1}{c}{\sffamily\color{white} #1}}
\def\tE{\cellcolor{trEven}}
\def\tO{\cellcolor{trOdd}}
\newcommand\Thr[1]{\cellcolor{th}\sffamily\color{white}{#1}}
\newcommand\tablenote[1]{\par\vspace*{1em}\par{\small{\sffamily 注：}#1}}

% 字体
\usepackage{fontspec}
% \setmainfont[BoldFont={SourceHanSansSC-Medium}]{Source Han Serif SC}
\setCJKmainfont{Source Han Serif SC}
% \setsansfont[BoldFont={SourceHanSansSC-Bold}]{Source Han Sans SC}
\setCJKsansfont{Source Han Sans SC}
% \setCJKmonofont[BoldFont={Kaiti SC Bold}]{Kaiti SC Regular}

% 页面背景
\usepackage[scale=1, angle=0, hshift=0, vshift=0, placement=top]{background}
\backgroundsetup{
    pages=some,
    position={0,0},
    contents={
    % \def\tikz@width{\pagewidth}
    % \def\tikz@height{\pageheight}
    \begin{tikzpicture}
    \begin{scope}[fill]
        \skipdef\r=0
        \skipdef\x=30
        \skipdef\y=30
        % \draw[step=1,gray,very thin] (0,0) grid (500,500);
        % \node at (10, 20) {\zihao{1}\color{LightRose}-\thepage-};
        \tikz \foreach \i in {1,...,3}
            \pgfmathsetlength{\x}{random(0,400)}
            \pgfmathsetlength{\y}{random(0,400)}
            \pgfmathsetlength{\r}{random(30,80)}
            \fill[MistyRose] (\x,\y) circle (\r);
            % \fill[SmrtSunglo] (\x,\pgfmathparse{random(0,\x)}\pgfmathresult) circle (\pgfmathparse{random(0,\x)}\pgfmathresult cm);
    \end{scope}
    \end{tikzpicture}}
}

% 页眉和页脚
\usepackage{fancyhdr}
\pagestyle{fancy}
\newcommand\myleft{\color{darkgray}\kaishu\leftmark}
\newcommand\myright{\color{darkgray}\kaishu\rightmark}
\fancyhf{}
\fancyfoot[LE, RO]{\myfoot}
\fancyhead[LE]{\myleft}
\fancyhead[RO]{\myright}
\renewcommand{\headrulewidth}{0pt} % 注意不用 \setlength
\renewcommand{\footrulewidth}{0pt}
\fancypagestyle{plain}{ %
    \fancyhf{} % remove everything
    \fancyfoot[LE, RO]{\myfoot}
    \fancyhead[LE]{\myleft}
    \fancyhead[RO]{\myright}
    \renewcommand{\headrulewidth}{0pt} % remove lines as well
    \renewcommand{\footrulewidth}{0pt}
}

% 章节样式
\ctexset{
    space=true,
    punct=quanjiao,
    chapter = {
        beforeskip = 0pt,
        afterskip = 20pt,
        fixskip = true,
        format = \Huge\sffamily\bfseries\setlength\parindent{0pt},
        nameformat = \par\chapternamebox,
        number = \arabic{chapter},
        numberformat = \color{CarminePink}\zihao{0}\itshape,
        aftertitle = \par\bigskip\nointerlineskip{\color{LightPink}\rule{\linewidth}{1pt}}\par
    },
    section = {
        beforeskip = 10pt plus 6pt minus 10pt,
        afterskip = 4pt plus 6pt minus 4pt,
        format = \Large\sffamily\bfseries\raggedright ,
        numberformat = \color{CarminePink},
    },
    subsection = {
        beforeskip = 6pt plus 6pt minus 6pt,
        afterskip = 4pt plus 6pt minus 4pt,
        format = \large\sffamily\bfseries\raggedright ,
        numberformat = \color{CarminePink},
    },
    subsubsection = {
        beforeskip = 4pt plus 6pt minus 4pt,
        afterskip = 4pt plus 6pt minus 4pt,
        format = \sffamily\bfseries,
        numberformat = \color{CarminePink},
    },
    paragraph = {
        format = \large\sffamily\bfseries\color{CarminePink},
        % aftertitle = \@@par,
    },
    subparagraph = {
        format = \sffamily\bfseries,
    }
}
\newcommand\chapternamebox[1]{%
\includegraphics[width=1cm]{image/title_label.pdf}{\zihao{2} #1}}
\newcommand\subsubsectionnamebox[1]{%
\tcbox[colback=white,colframe=CarminePink]{#1}}

% 交叉引用
\usepackage{nameref}
\usepackage{prettyref}
\newrefformat{fig}{{\color{CarminePink}\underline{图\ref{#1}}}}
\newrefformat{tab}{{\color{CarminePink}\underline{表\ref{#1}}}}
% \newrefformat{cha}{{\color{CarminePink}\underline{第\ref{#1}章\nameref{#1}}}}
% \newrefformat{app}{{\color{CarminePink}\underline{附录\ref{#1}\nameref{#1}}}}
% \newrefformat{sec}{{\color{CarminePink}\underline{第\ref{#1}节\nameref{#1}}}}
\newrefformat{cha}{{\color{CarminePink}\underline{第\pageref{#1}页第\ref{#1}章\nameref{#1}}}}
\newrefformat{app}{{\color{CarminePink}\underline{第\pageref{#1}页附录\ref{#1}\nameref{#1}}}}
\newrefformat{sec}{{\color{CarminePink}\underline{第\pageref{#1}页 \ref{#1} \nameref{#1}}}}

% 图表
\usepackage{caption}
\captionsetup[table]{labelsep=space,labelfont=bf}
\captionsetup[figure]{labelsep=space,labelfont=bf} 
\setlength{\abovecaptionskip}{6pt}
\setlength{\belowcaptionskip}{8pt}
% \setlength{\textfloatsep}{0.6\baselineskip plus 0.2\baselineskip minus 0.5\baselineskip}
\setlength{\textfloatsep}{0pt}

% 目录
\usepackage{titlesec}
\usepackage{titletoc}
\contentsmargin{2em}
\dottedcontents{chapter}[4em]{\addvspace{6pt}\sffamily}{4em}{1mm}
\dottedcontents{section}[5em]{}{3em}{1mm}
\dottedcontents{subsection}[7em]{}{4em}{1mm}
\dottedcontents{subsubsection}[9em]{}{4em}{1mm}
% \titlecontents{section}
%               [3cm]
%               {\bf \large}%
%               {\contentslabel{2.5em}}%
%               {}%
%               {\titlerule*[0.5pc]{$\cdot$}\contentspage\hspace*{3cm}}%

% 超链接
\usepackage{hyperref}
\hypersetup{
    bookmarksnumbered=true,
    linktoc=page,
    % linktocpage=true,
    colorlinks=true,
    linkcolor=CarminePink,
    % anchorcolor=black,
% citecolor [green]
% filecolor [cyan]
% menucolor [red]
% runcolor [cyan - same as file color]
urlcolor=CarminePink,
% allcolors -- use this if you want to set all links to the same color
}

% 脚注
% \usepackage{perpage} %the perpage package
% \MakePerPage{footnote} %the perpage package command

% 列表
\usepackage{enumitem}
\setlist{nosep}
\setlist[enumerate, 1]{label=(\arabic*)}
\setlist[enumerate, 2]{label=(\alpa*)}
\setlist[itemize]{font=\sffamily\bfseries}
\setlist[description]{font=\sffamily\bfseries}
% \setlist[itemize, 1]{align=left, labelindent*=1em, topsep={1pt plus 1pt minus 1pt}, itemsep={3pt plus 1pt minus 2pt}}
% \setlist[itemize, 2]{leftmargin=0em, topsep={2pt plus 2pt minus 1.5pt}, partopsep={3pt plus 2pt minus 3pt}, itemsep={1pt plus 1pt minus 1pt}, parsep={1pt plus 1pt minus 1pt}}

% 行和段落
\linespread{1.4}

% 参考文献
% \bibliographystyle{...}

% 自定义指令
\newcommand{\LM}{{\sf L~MASTER™}}
\newcommand{\innerinfo}[3]{{\setlength{\parindent}{0pt}\par
    {\begin{minipage}[t]{0.18\linewidth}
    \vspace{0pt}
    #1
    \end{minipage}}
    {\begin{minipage}[t]{0.8\linewidth}
    \setlist[itemize]{leftmargin=1.5em}
    \vspace{0pt}
    {\sffamily\bfseries #2}\par\kaishu #3
    \end{minipage}\smallskip}
}
}
\newcommand{\info}[1]{\innerinfo{\includegraphics[width=1.5cm]{image/ic_w_info.pdf}}{注意：}{#1}}
\newcommand{\dange}[1]{\innerinfo{\includegraphics[width=1.5cm]{image/ic_w_flash.pdf}}{有电危险：}{#1}}
\newcommand{\danger}[2][危险]{\innerinfo{\includegraphics[width=1.5cm]{image/ic_w_warning.pdf}}{#1：}{#2}}

% 单位
\newcommand{\unit}[1]{\,\mathrm{#1}}
\newcommand{\Nm}{\unit{N\!\cdot\! m}}
\newcommand{\kg}{\unit{kg}}
\newcommand{\cm}{\unit{cm}}
\newcommand{\mm}{\unit{mm}}
\newcommand{\oC}{\unit{^\circ C}}

\tcbset{boxsep=0mm,nobeforeafter,center title,tcbox raise base}
\newcommand{\btn}[2][Primary]{\tcbox[left=10pt,right=10pt,top=4pt,bottom=4pt,colframe=#1,colback=#1,colupper=white,arc=8pt]{#2}}
\newcommand{\kbd}[1]{\tcbox[left=4pt,right=4pt,top=4pt,bottom=4pt,colframe=LightRose,colback=white]{#1}}
\newcommand{\mnu}[1]{\tcbox[left=2pt,right=2pt,top=2pt,bottom=2pt,arc=1pt,colframe=LightRose,colback=white]{#1}}
\newcommand{\icn}[2][]{{\includegraphics[height=1em]{#2}}}

\setcounter{secnumdepth}{3}
\setcounter{tocdepth}{3}

\newcommand{\ThisBook}{本手册} % {《用户手册》}
\newcommand{\eBook}{电子版用户手册}
\newcommand{\ThatBook}{《服务指南》}
