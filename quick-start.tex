% !TEX program = xelatex
\documentclass[UTF8, 10pt, twoside]{ctexrep}

% 编程
\usepackage{ifthen}

% 数学
\usepackage{amsmath}
\usepackage{amssymb}
\everymath{\displaystyle}

% 颜色
\usepackage[dvipsnames, cmyk]{xcolor}
\definecolor{CarminePink}{HTML/cmyk}{E84746/0.01,0.83,0.71,0.01}
\definecolor{SmrtSunglo}{HTML}{EB6160}
\definecolor{LightCoral}{HTML}{EE7B7A}
\definecolor{SeaPink}{HTML}{F19595}
\definecolor{BeautyBush}{HTML}{F5B0AF}
\definecolor{LightRose}{HTML}{F8CACA}
\definecolor{MistyRose}{HTML}{FBE4E4}

\definecolor{Primary}{HTML}{1E5AF0}
\definecolor{Info}{HTML}{8296A6}
\definecolor{Card}{HTML}{374148}

% 绘图
\usepackage{tikz}
\usetikzlibrary{shapes,backgrounds}

% 字体
\usepackage{fontspec}
% \setmainfont[BoldFont={SourceHanSansSC-Medium}]{Source Han Serif SC}
\setCJKmainfont{Source Han Serif SC}
% \setsansfont[BoldFont={SourceHanSansSC-Bold}]{Source Han Sans SC}
\setCJKsansfont{Source Han Sans SC}
% \setCJKmonofont[BoldFont={Kaiti SC Bold}]{Kaiti SC Regular}

% 中文排版设置
\ctexset{
    space=true,
    punct=quanjiao,
    chapter = {
        beforeskip = 0pt,
        fixskip = true,
        format = \Huge\bfseries\CTEXnoindent,
        nameformat = {\color{lightgray}\rule{\linewidth}{1bp}}\par\chapternamebox,
        number = \arabic{chapter},
        numberformat = \color{CarminePink}\zihao{0}\itshape,
        % aftername = \par\medskip,
        aftertitle = \par\bigskip\nointerlineskip{\color{LightRose}\rule{\linewidth}{2bp}}\par
    }
}
\newcommand\chapternamebox[1]{%
\includegraphics[width=1cm]{image/title_label.pdf}{\zihao{2} #1}}

% 页面设置
\usepackage[papersize={13cm,18.4cm},hmargin=1.60cm,vmargin=2.10cm]{geometry}

% 页面背景
\usepackage[scale=1, angle=0, hshift=0, vshift=0, placement=top]{background}
\backgroundsetup{
    position={0,0},
    contents={
    % \def\tikz@width{\pagewidth}
    % \def\tikz@height{\pageheight}
    \begin{tikzpicture}
    \begin{scope}[fill opacity=0.5]
        \skipdef\r=0
        \skipdef\x=30
        \skipdef\y=30
        \draw[step=1,gray,very thin] (0,0) grid (500,500);
        % \node at (10, 20) {\zihao{1}\color{LightRose}-\thepage-};
        \tikz \foreach \i in {1,...,3}
            \pgfmathsetlength{\x}{random(0,400)}
            \pgfmathsetlength{\y}{random(0,400)}
            \pgfmathsetlength{\r}{random(30,80)}
            \fill[MistyRose] (\x,\y) circle (\r);
            % \fill[SmrtSunglo] (\x,\pgfmathparse{random(0,\x)}\pgfmathresult) circle (\pgfmathparse{random(0,\x)}\pgfmathresult cm);
    \end{scope}
    \end{tikzpicture}}
}

% 页眉和页脚
\usepackage{fancyhdr}
\pagestyle{fancy}
\newcommand\myfoot{\zihao{3}\color{LightRose}\sffamily--~\thepage~--}
\newcommand\myleft{\color{SmrtSunglo}\kaishu\leftmark}
\newcommand\myright{\color{SmrtSunglo}\kaishu\rightmark}
\fancyhf{}
\fancyfoot[LE,RO]{\myfoot}
\fancyhead[LO]{\myleft}
\fancyhead[RE]{\myright}
\renewcommand{\headrulewidth}{0pt} % 注意不用 \setlength
\renewcommand{\footrulewidth}{0pt}
\fancypagestyle{plain}{ %
    \fancyhf{} % remove everything
    \fancyfoot[LE,RO]{\myfoot}
    \fancyhead[LO]{\myleft}
    \fancyhead[RE]{\myright}
    \renewcommand{\headrulewidth}{0pt} % remove lines as well
    \renewcommand{\footrulewidth}{0pt}
}
% 章节样式
% \usepackage{titlesec}
% \titleformat{\chapter}
% [hang]
% {\sffamily\centering}
% {\zihao{4} 第{\thechapter}章\enspace}
% {0pt}
% {\zihao{4} \bfseries}
% [\vbox{\color{Melon}\titlerule \vspace{1pt} \titlerule}]
% \titlespacing{\chapter}{0pt}{*0.2}{*0.3}

% \titleformat{\section}[block]{\zihao{-4}\bfseries}{\S\thechapter.\arabic{section}}{1em}{}[]
% \titleformat{\subsection}[block]{\Large\itshape\mdseries}{\arabic{section}.\arabic{subsection}}{1em}{}[]
% \titleformat{\subsubsection}[block]{\normalsize\bfseries}{\arabic{subsection}-\alph{subsubsection}}{1em}{}[]
% \titleformat{\paragraph}[block]{\small\bfseries}{[\arabic{paragraph}]}{1em}{}[]

% 超链接
\usepackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=SmrtSunglo,
% anchorcolor [black]
% citecolor [green]
% filecolor [cyan]
% menucolor [red]
% runcolor [cyan - same as file color]
% urlcolor [magenta]
% allcolors -- use this if you want to set all links to the same color
}
% 交叉引用
\usepackage{nameref}
\usepackage{prettyref}
\newrefformat{fig}{{\color{SmrtSunglo}\underline{图\ref{#1}}}}
\newrefformat{tab}{{\color{SmrtSunglo}\underline{表\ref{#1}}}}
\newrefformat{cha}{{\color{SmrtSunglo}\underline{第\ref{#1}章}\nameref{#1}}}
\newrefformat{app}{{\color{SmrtSunglo}\underline{附录\ref{#1}}\nameref{#1}}}
\newrefformat{sec}{{\color{SmrtSunglo}\underline{第\ref{#1}节}\nameref{#1}}}

% 索引
\usepackage{makeidx}
\makeindex

% 图片
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{tcolorbox}

% 表格
\usepackage{array}
\usepackage{tabularx}
\usepackage{multirow}
\newcommand{\minitab}[2][l]{\begin{tabular}{#1}#2\end{tabular}}

% 列表
\usepackage{enumitem}
\setlist{nosep}
\setlist[enumerate, 1]{label=(\arabic*)}
\setlist[enumerate, 2]{label=(\alpa*)}
\setlist[itemize]{font=\sffamily}
\setlist[description]{font=\sffamily}
% \setlist[itemize, 1]{align=left, labelindent*=1em, topsep={1pt plus 1pt minus 1pt}, itemsep={3pt plus 1pt minus 2pt}}
% \setlist[itemize, 2]{leftmargin=0em, topsep={2pt plus 2pt minus 1.5pt}, partopsep={3pt plus 2pt minus 3pt}, itemsep={1pt plus 1pt minus 1pt}, parsep={1pt plus 1pt minus 1pt}}

% 行和段落
\linespread{1.4}

% 参考文献
% \bibliographystyle{...}

% 自定义指令
\newcommand{\LM}{{\sf L~MASTER™}}
\newcommand{\innerinfo}[3]{\par\vspace{0.4em}\noindent
    {\begin{minipage}[t]{0.2\linewidth}
    \vspace{0pt}
    #1
    \end{minipage}}
    {\begin{minipage}[t]{0.8\linewidth}
    \vspace{0pt}
    {\sffamily\bfseries #2}\par\kaishu #3
    \end{minipage}}
}
\newcommand{\info}[1]{\innerinfo{\includegraphics[width=1.8cm]{image/18.pdf}}{注意：}{#1}}
\newcommand{\dange}[1]{\innerinfo{\includegraphics[width=1.8cm]{image/19.pdf}}{有电危险：}{#1}}
\newcommand{\danger}[2][危险]{\innerinfo{\includegraphics[width=1.8cm]{image/20.pdf}}{#1：}{#2}}

% 单位
\newcommand{\unit}[1]{\,\mathrm{#1}}
\newcommand{\Nm}{\unit{N\cdot m}}
\newcommand{\kg}{\unit{kg}}
\newcommand{\cm}{\unit{cm}}
\newcommand{\mm}{\unit{mm}}

\begin{document}

\tcbset{boxsep=0mm,nobeforeafter,center title,tcbox raise base}
\newcommand{\btn}[2][Primary]{\tcbox[left=10pt,right=10pt,top=4pt,bottom=4pt,colframe=#1,colback=#1,colupper=white,arc=8pt]{#2}}
\newcommand{\kbd}[1]{\tcbox[left=4pt,right=4pt,top=4pt,bottom=4pt,colframe=LightRose,colback=white]{#1}}
\newcommand{\mnu}[1]{\tcbox[left=2pt,right=2pt,top=2pt,bottom=2pt,arc=1pt,colframe=Primary,colback=white]{#1}}
\newcommand{\icn}[2][white]{\colorbox{#1}{\includegraphics[height=1em]{#2}}}

% \zihao{6}
% \include{title}
% \include{copyright}
% \setcounter{page}{1}
\setcounter{tocdepth}{3}
{\small\tableofcontents}
\include{preface}
\renewcommand{\chaptermark}[1]{\markboth{\thechapter\ #1}{}}
\renewcommand{\sectionmark}[1]{\markright{\thesection\ #1}}
\include{prepare}
\include{basic}
\include{using}
\include{reset}
\include{repair}
\include{support}
\appendix
\include{standard}
\listoftables
\listoffigures
\printindex % 索引 makeindex
%\bibliography{...} % 参考文献 bibtex
% \include{pdfs}
% \include{cover}
\end{document}
